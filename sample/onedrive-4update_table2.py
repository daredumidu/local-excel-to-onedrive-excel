# update data in the table

import requests
import os.path
import os
import re
import pandas as pd
import json


latest_excel_file = 'C:\\programs\\excel-onedrive\\data.xlsx'

df = pd.read_excel('%s' % latest_excel_file, sheet_name='Scan Information')
#print (df)

df1 = df.to_json(orient='values')
#print (df1)

df2 = '{"index":0,"values":'+df1+'}'
#print (df2)

payload = json.loads(df2)
print (payload)


token = 'eyJ0eXAiOiJKV1QiLCJub25jZSI6IjhNYWxwSmU2SVFKUGY5Z3dnZUNiMnRUazBZTjN6MkUxX2p5R0t3MnFiWkUiLCJhbGciOiJSUzI1NiIsIng1dCI6IlNzWnNCTmhaY0YzUTlTNHRycFFCVEJ5TlJSSSIsImtpZCI6IlNzWnNCTmhaY0YzUTlTNHRycFFCVEJ5TlJSSSJ9.eyJhdWQiOiIwMDAwMDAwMy0wMDAwLTAwMDAtYzAwMC0wMDAwMDAwMDAwMDAiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC84Y2M0MzRkNy05N2QwLTQ3ZDMtYjVjNS0xNGZlMGUzM2UzNGIvIiwiaWF0IjoxNTkzNjk4MjgwLCJuYmYiOjE1OTM2OTgyODAsImV4cCI6MTU5MzcwMjE4MCwiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IkFTUUEyLzhRQUFBQUhiSjBpeE5HZ3MzTXp6dFE3cVZnemZ3STBhYXhlZzdkd1paaG1ENHc3RUE9IiwiYXBwX2Rpc3BsYXluYW1lIjoiR3JhcGggZXhwbG9yZXIgKG9mZmljaWFsIHNpdGUpIiwiYXBwaWQiOiJkZThiYzhiNS1kOWY5LTQ4YjEtYThhZC1iNzQ4ZGE3MjUwNjQiLCJhcHBpZGFjciI6IjAiLCJmYW1pbHlfbmFtZSI6IlNlbmFuYXlha2UiLCJnaXZlbl9uYW1lIjoiRHVtaWR1IiwiaXBhZGRyIjoiMTc1LjE1Ny4xODguMTEyIiwibmFtZSI6IlNlbmFuYXlha2UsIER1bWlkdSIsIm9pZCI6IjUyODJmNDlmLTYwZDgtNDllOC04ZmMwLTJmZmQzYmYyMDY2NSIsIm9ucHJlbV9zaWQiOiJTLTEtNS0yMS0xMDg1MDMxMjE0LTIwMDA0NzgzNTQtODM5NTIyMTE1LTk1MTk5NCIsInBsYXRmIjoiMyIsInB1aWQiOiIxMDAzMjAwMDUzNUY4QkYxIiwic2NwIjoiQ2FsZW5kYXJzLlJlYWRXcml0ZSBDaGF0LlJlYWQgQ29udGFjdHMuUmVhZFdyaXRlIERldmljZU1hbmFnZW1lbnRBcHBzLlJlYWQuQWxsIERldmljZU1hbmFnZW1lbnRBcHBzLlJlYWRXcml0ZS5BbGwgRGV2aWNlTWFuYWdlbWVudENvbmZpZ3VyYXRpb24uUmVhZC5BbGwgRGV2aWNlTWFuYWdlbWVudENvbmZpZ3VyYXRpb24uUmVhZFdyaXRlLkFsbCBEZXZpY2VNYW5hZ2VtZW50TWFuYWdlZERldmljZXMuUHJpdmlsZWdlZE9wZXJhdGlvbnMuQWxsIERldmljZU1hbmFnZW1lbnRNYW5hZ2VkRGV2aWNlcy5SZWFkLkFsbCBEZXZpY2VNYW5hZ2VtZW50TWFuYWdlZERldmljZXMuUmVhZFdyaXRlLkFsbCBEZXZpY2VNYW5hZ2VtZW50UkJBQy5SZWFkLkFsbCBEZXZpY2VNYW5hZ2VtZW50UkJBQy5SZWFkV3JpdGUuQWxsIERldmljZU1hbmFnZW1lbnRTZXJ2aWNlQ29uZmlnLlJlYWQuQWxsIERldmljZU1hbmFnZW1lbnRTZXJ2aWNlQ29uZmlnLlJlYWRXcml0ZS5BbGwgRGlyZWN0b3J5LkFjY2Vzc0FzVXNlci5BbGwgRGlyZWN0b3J5LlJlYWQuQWxsIERpcmVjdG9yeS5SZWFkV3JpdGUuQWxsIEV4dGVybmFsSXRlbS5SZWFkLkFsbCBGaWxlcy5SZWFkIEZpbGVzLlJlYWQuQWxsIEZpbGVzLlJlYWRXcml0ZS5BbGwgRmlsZXMuUmVhZFdyaXRlLkFwcEZvbGRlciBHcm91cC5SZWFkLkFsbCBHcm91cC5SZWFkV3JpdGUuQWxsIElkZW50aXR5Umlza0V2ZW50LlJlYWQuQWxsIE1haWwuUmVhZFdyaXRlIE1haWxib3hTZXR0aW5ncy5SZWFkV3JpdGUgTm90ZXMuUmVhZFdyaXRlLkFsbCBvcGVuaWQgUGVvcGxlLlJlYWQgcHJvZmlsZSBSZXBvcnRzLlJlYWQuQWxsIFNpdGVzLlJlYWRXcml0ZS5BbGwgVGFza3MuUmVhZFdyaXRlIFVzZXIuUmVhZCBVc2VyLlJlYWRCYXNpYy5BbGwgVXNlci5SZWFkV3JpdGUgVXNlci5SZWFkV3JpdGUuQWxsIGVtYWlsIiwic2lnbmluX3N0YXRlIjpbImttc2kiXSwic3ViIjoiNnFyNm1ZNEQyTE9RcFJ2eWYweFhFN3NQa0k2T005dTFVeFp0UndkMVZvOCIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJOQSIsInRpZCI6IjhjYzQzNGQ3LTk3ZDAtNDdkMy1iNWM1LTE0ZmUwZTMzZTM0YiIsInVuaXF1ZV9uYW1lIjoiZHVtaWR1LnNlbmFuYXlha2VAcGVhcnNvbi5jb20iLCJ1cG4iOiJkdW1pZHUuc2VuYW5heWFrZUBwZWFyc29uLmNvbSIsInV0aSI6InpudVF3RW81OGstZXM2eUtXekJPQUEiLCJ2ZXIiOiIxLjAiLCJ4bXNfc3QiOnsic3ViIjoiQW5ubzJpcGJJa1JkamhyQmM5amhtU21yNDZQcWppVklHcTMzLVVHbThvNCJ9LCJ4bXNfdGNkdCI6MTM0MTUxNDA5M30.uDBeQ-qRB3nRJ4ZFNHavyU4EQ-UbWdGrmXPaPNU8q1SE_NN3QZPjn2FtdKA4xHwb14xrYwQy5AUzpSm1UyKEEJWAR6qmQE_fYW7gdT3edq9bAhVFibtPdRHRcTMHxf_PtqkszarPYDhclAGVhJ5fJH70Xm3cirYHxpRg1TTm6lGLp6aYal-NO06AHDxzMESw9VW7sLz1ue4kaorD2D9vKw-b1ApU3wzmwZZUtMTdd3SuuAD7daX3s8buv2O1K4epzm4q7WOjkBIvr0r9Huj63UDv0G_SijlZ8gUtd5ztmvDrE_CicWyXHvu7ydf6iAuoAmxa7_rtOOLXzKMFb-N7lw'

headers = {'Authorization': 'Bearer {}'.format(token)}

url = 'https://graph.microsoft.com/v1.0/me/drive/items/01JOZHAQM4NMM4SS3CZ5EY3WJWYBHHITOD/workbook/tables(\'1\')/rows'

r = requests.post(url, headers = headers, json = payload).text

print (r)
